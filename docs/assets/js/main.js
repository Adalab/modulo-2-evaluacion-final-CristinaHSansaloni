"use strict";const userInput=document.querySelector(".js_input"),btnSearch=document.querySelector(".js_search"),btnReset=document.querySelector(".js_reset"),resultsList=document.querySelector(".js_results"),favoritesList=document.querySelector(".js_favorites"),btnRemoveFav=document.querySelector(".js-btnRemoveFav"),imgNotFound="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png",newImage="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";let cardFounded=[],cardFavorites=[],cardSelected=[];function getData(){fetch("https://api.jikan.moe/v4/anime?q="+userInput.value).then(e=>e.json()).then(e=>{console.log(e),cardFounded=e.data,renderCardFounded()})}function renderCardFounded(){let e="",t="";cardFounded.forEach(a=>{const r=cardSelected.findIndex(e=>a.mal_id===e.mal_id);t=-1!==r?"selected":"",a.images.jpg.image_url===imgNotFound?(e+=`<li class="js-list-cards ${t}" id=${a.mal_id}>`,e+=`<img src="${newImage}"`,e+=`<h3>${a.title}</h3>`):(e+=`<li class="js-list-cards ${t}" id=${a.mal_id}>`,e+=`<img src="${a.images.jpg.image_url}" />`,e+=`<h3>${a.title}</h3>`,e+="</li>")}),resultsList.innerHTML=e,listenerCards()}function renderFav(){let e="";cardFavorites.forEach(t=>{t.images.jpg.image_url===imgNotFound&&(e+=`<li class="js-fav-cards id=${t.mal_id}>`,e+=`<img src="${newImage}"/>`,e+=`<h3>${t.title}</h3>`,e+="</li>")}),favoritesList.innerHTML=e,listenerFav()}function removeFav(){cardFavorites=[],cardSelected=[],favoritesList.innerHTML="",renderCardFounded(),saveFav()}function saveSelected(){localStorage.setItem("cardSelected",JSON.stringify(cardSelected))}function loadSelected(){const e=JSON.parse(localStorage.getItem("cardSelected"));null!==e&&(cardSelected=e,renderCardFounded())}function saveFav(){localStorage.setItem("favoritesList",JSON.stringify(cardFavorites))}function loadFav(){const e=JSON.parse(localStorage.getItem("favoritesList"));null!==e&&(cardFavorites=e,renderFav())}function listenerCards(){const e=document.querySelectorAll(".js-list-cards");for(const t of e)t.addEventListener("click",handleClickCard)}function listenerFav(){const e=document.querySelectorAll(".js-fav-cards");for(const t of e)t.addEventListener("click",handleClickFav)}const handleFilter=e=>{e.preventDefault();const t=userInput.value.toLowerCase(),a=cardFounded.filter(e=>e.title.toLowerCase().includes(t));getData(),renderCardFounded(a)};function handleReset(e){e.preventDefault(),userInput.value="",cardFounded.innerHTML=""}function handleClickCards(e){const t=parseInt(e.currentTarget.id),a=cardFounded.find(e=>e.mal_id===t);-1===cardFavorites.findIndex(e=>a.mal_id===t)&&(cardFavorites.push(a),cardSelected.push(a)),renderCardFounded(),renderFav(),saveFav(),saveSelected()}function handleClickFavorites(e){const t=parseInt(e.currentTarget.id),a=cardFavorites.findIndex(e=>e.mal_id===t),r=cardSelected.findIndex(e=>e.mal_id===a);cardFavorites.splice(a,1),cardSelected.splice(r,1),renderCardFounded(),renderFav()}userInput.addEventListener("click",handleFilter),btnSearch.addEventListener("click",handleFilter),btnReset.addEventListener("click",handleReset),loadFav(),loadSelected();